<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Sorcerer-admins] Augur man page and GCC optimization
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/sorcerer-admins/2013/index.html" >
   <LINK REL="made" HREF="mailto:sorcerer-admins%40lists.berlios.de?Subject=Re%3A%20%5BSorcerer-admins%5D%20Augur%20man%20page%20and%20GCC%20optimization&In-Reply-To=%3CCAER78vSgUC%2BSG4-oh3sV_ANEgH9GNfUFp8CyYXZ%2B%2BBG2FjCypQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002493.html">
   <LINK REL="Next"  HREF="002498.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Sorcerer-admins] Augur man page and GCC optimization</H1>
    <B>Evert Vorster</B> 
    <A HREF="mailto:sorcerer-admins%40lists.berlios.de?Subject=Re%3A%20%5BSorcerer-admins%5D%20Augur%20man%20page%20and%20GCC%20optimization&In-Reply-To=%3CCAER78vSgUC%2BSG4-oh3sV_ANEgH9GNfUFp8CyYXZ%2B%2BBG2FjCypQ%40mail.gmail.com%3E"
       TITLE="[Sorcerer-admins] Augur man page and GCC optimization">evorster at gmail.com
       </A><BR>
    <I>Sun Dec  8 08:20:57 CET 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="002493.html">[Sorcerer-admins] Augur man page and GCC optimization
</A></li>
        <LI>Next message: <A HREF="002498.html">[Sorcerer-admins] Augur man page and GCC optimization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2495">[ date ]</a>
              <a href="thread.html#2495">[ thread ]</a>
              <a href="subject.html#2495">[ subject ]</a>
              <a href="author.html#2495">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorcerer tries to get good defaults as much as possible. In fact,
there is a lot of chatter between me and Kyle from time to time as to
what the default should be, and so on.

If you do find that you have to make modifications to the kernel, the
process is rather straightforward, as long as you are prepared to be
surgical about it.

# cd /usr/share/src/linux
# make menuconfig

This should pop you into the normal linux kernel configuration screen.
Load .config.stock
That is the config that Sorcerer suggest. Make the changes that you
need to make.
Save it as .config.custom

Re-cast linux-kernel and linux-modules to apply your changes to the system.




On 8 December 2013 01:14, chessmaster &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">knowledgeispower80 at gmail.com</A>&gt; wrote:
&gt;<i> Thanks! I was just curious. I'm fine with default as I do understand
</I>&gt;<i> optimization flags is extremely overated. I rather have a stable system than
</I>&gt;<i> worry about what flags to use for ffmpeg etc...... When I did the &quot;au sync&quot;
</I>&gt;<i> I notice while updating there was a kernel update. Is the kernel update user
</I>&gt;<i> configured or automatic? I was afriad to update. Since on other related
</I>&gt;<i> source-based POSIX the user has to recompile the kernel when it is updated.
</I>&gt;<i> I acually hold off on that update until I find out what is done.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Sun, Dec 8, 2013 at 1:13 AM, Evert Vorster &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">evorster at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hmm, I am not sure, mainly because I have never tried.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Sorcery automatically detects the number of processors available, and
</I>&gt;&gt;<i> sets makeopts to the number of free cpu's, if safe to do so. If you
</I>&gt;&gt;<i> would like to turn off dynamic makeopts assignment, toggle feature
</I>&gt;&gt;<i> &quot;min&quot; in the sorcery feature menus.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> To further utilize all available CPU power, sorcery will compile as
</I>&gt;&gt;<i> many spells concurrently as it can. On Kyle's machine this is not a
</I>&gt;&gt;<i> problem, but on my i7's there is just too much horsepower and I run
</I>&gt;&gt;<i> into situations where strange things happen. I usually enable the
</I>&gt;&gt;<i> &quot;sequent&quot; feature which tells Sorcerer to compile sources serially. At
</I>&gt;&gt;<i> the end of the day, I don't see much difference, mainly because I
</I>&gt;&gt;<i> re-compile often and ccache is quite helpful when doing re-compiles.
</I>&gt;&gt;<i> One thing to watch out for.... compiling gcc wipes the ccache.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If not upgrading gcc, and just recompiling it, move /auc/can/ccache to
</I>&gt;&gt;<i> some temporary location on the same filesystem, cast gcc, then move
</I>&gt;&gt;<i> the ccache back.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hope that answers your questions?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 7 December 2013 23:06, chessmaster &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">knowledgeispower80 at gmail.com</A>&gt;
</I>&gt;&gt;<i> wrote:
</I>&gt;&gt;<i> &gt; Can I save 'export MAKEOPTS=&quot;-j8&quot;', in  /etc/sorcery/cpref/default
</I>&gt;&gt;<i> &gt; safely
</I>&gt;&gt;<i> &gt; without overwriting the defaults?  Enjoyed the installed and reading the
</I>&gt;&gt;<i> &gt; excellent install/post-install docs. :)
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; On Sat, Dec 7, 2013 at 9:29 PM, Evert Vorster &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">evorster at gmail.com</A>&gt;
</I>&gt;&gt;<i> &gt; wrote:
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Hi there, and welcome to Sorcerer.
</I>&gt;&gt;<i> &gt;&gt; augur does not have a manpage. Instead, just type &quot;augur&quot; on the
</I>&gt;&gt;<i> &gt;&gt; command line, and it will tel you it's options.
</I>&gt;&gt;<i> &gt;&gt; One of us might write a manpage someday...
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; On your second question, the short answer is yes it does, but you
</I>&gt;&gt;<i> &gt;&gt; don't want to mess with it.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Longer answer:
</I>&gt;&gt;<i> &gt;&gt; Because I know you want to mess with it, and it's your machine and
</I>&gt;&gt;<i> &gt;&gt; your right, I'll explain the mechanism to you, but if you blow up your
</I>&gt;&gt;<i> &gt;&gt; box, don't blame me.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Sorcery will by default read:
</I>&gt;&gt;<i> &gt;&gt; /etc/sorcery/cpref/default
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; If that file does not exist, sorcery will pick sensible defaults,
</I>&gt;&gt;<i> &gt;&gt; which you can fine-tune in the sorcery menu. You will basically get
</I>&gt;&gt;<i> &gt;&gt; optimization -O0 for most small packages, and -O2 for stuff that makes
</I>&gt;&gt;<i> &gt;&gt; sense to have optimized, and some esoteric flags for spells that needs
</I>&gt;&gt;<i> &gt;&gt; them.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; In the Sorcery menu, under &quot;Toggle&quot; sorcerer features, you can select
</I>&gt;&gt;<i> &gt;&gt; whether to compile for base architecture or not. This switches default
</I>&gt;&gt;<i> &gt;&gt; between -mtune=native and -march=native.
</I>&gt;&gt;<i> &gt;&gt; You can also switch on &quot;lto&quot; for link time optimizations. If you want,
</I>&gt;&gt;<i> &gt;&gt; switch on the complementary -Os for spells that have the &quot;lto&quot;
</I>&gt;&gt;<i> &gt;&gt; capability.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Now, if that is not specific enough for you, and you want to specify a
</I>&gt;&gt;<i> &gt;&gt; default that is different from what I described above, here is how:
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; # mkdir -p /etc/sorcery/cpref
</I>&gt;&gt;<i> &gt;&gt; # nano mtune-O2
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; inside, put your CFLAGS, like so:
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; export CFLAGS=&quot;$CFLAGS -march=native -O2 -pipe -fno-warnings &quot;
</I>&gt;&gt;<i> &gt;&gt; export CXXFLAGS=&quot;$CFLAGS &quot;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Or whatever you may like.
</I>&gt;&gt;<i> &gt;&gt; To make sorcerer compile with those enabled,
</I>&gt;&gt;<i> &gt;&gt; # ln -s /etc/sorcery/cpref/mtune-O2 /etc/sorcery/cpref/default
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Please let me re-iterate that this changes the defaults to whatever
</I>&gt;&gt;<i> &gt;&gt; you put in that file, and can completely break your box. Also, it
</I>&gt;&gt;<i> &gt;&gt; probably won't have the desired effect of making everything faster. I
</I>&gt;&gt;<i> &gt;&gt; used to run with a default cpref pretty close to the one I described
</I>&gt;&gt;<i> &gt;&gt; until very recently. Now I don't, and let sorcery pick the cflags for
</I>&gt;&gt;<i> &gt;&gt; spells, and my desktop &quot;feels&quot; more responsive.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; However, there is some really useful application for when you want to
</I>&gt;&gt;<i> &gt;&gt; mess with just one spell's cflags:
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; # augur cpref $SPELL &lt;tab&gt; &lt;tab&gt;   &lt;- will list the files in
</I>&gt;&gt;<i> &gt;&gt; /etc/sorcery/cpref
</I>&gt;&gt;<i> &gt;&gt; # augur cpref $SPELL $CPREF_FILE    &lt;- will set that spell to utilize
</I>&gt;&gt;<i> &gt;&gt; the cpref file that you make.
</I>&gt;&gt;<i> &gt;&gt; # augur cpref $SPELL  &lt;- will clear the custom cpref for that file
</I>&gt;&gt;<i> &gt;&gt; # augur cpref    &lt;- will just list the spells with custom cpref
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; For instance, I have in i7 laptop. Current firefox segfaults when
</I>&gt;&gt;<i> &gt;&gt; -march=native is passed to it, because it gcc gets the avx features of
</I>&gt;&gt;<i> &gt;&gt; my CPU wrong. Just for firefox. strange, but I like compiling for my
</I>&gt;&gt;<i> &gt;&gt; cpu type, so now I have the following file
</I>&gt;&gt;<i> &gt;&gt; /etc/sorcery/cpref/firefox
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Contents of which:
</I>&gt;&gt;<i> &gt;&gt; export CFLAGS=&quot; $CFLAGS -mno-avx &quot;
</I>&gt;&gt;<i> &gt;&gt; export CXXFLAGS=&quot; $CXXFLAGS -mno-avx &quot;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; I issued the following command:
</I>&gt;&gt;<i> &gt;&gt; augur cpref firefox firefox
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; And now just firefox is compiled with the added -mno-avx
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; The same mechanism can be applied to any single spell that you want to
</I>&gt;&gt;<i> &gt;&gt; mess with, and limits the potential damage to the rest of your box.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Have fun.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; On 7 December 2013 18:02, chessmaster &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">knowledgeispower80 at gmail.com</A>&gt;
</I>&gt;&gt;<i> &gt;&gt; wrote:
</I>&gt;&gt;<i> &gt;&gt; &gt; Hello everyone! I was curious to ask if augur has a man page? Also,
</I>&gt;&gt;<i> &gt;&gt; &gt; is
</I>&gt;&gt;<i> &gt;&gt; &gt; there
</I>&gt;&gt;<i> &gt;&gt; &gt; a configuration file that stores GCC optimization flags?
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; Regards,
</I>&gt;&gt;<i> &gt;&gt; &gt; Roosevelt
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; _______________________________________________
</I>&gt;&gt;<i> &gt;&gt; &gt; Sorcerer-admins mailing list
</I>&gt;&gt;<i> &gt;&gt; &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">Sorcerer-admins at lists.berlios.de</A>
</I>&gt;&gt;<i> &gt;&gt; &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">https://lists.berlios.de/mailman/listinfo/sorcerer-admins</A>
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; --
</I>&gt;&gt;<i> &gt;&gt; Evert Vorster
</I>&gt;&gt;<i> &gt;&gt; Chief Observer
</I>&gt;&gt;<i> &gt;&gt; WG Cook
</I>&gt;&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;&gt;<i> &gt;&gt; Sorcerer-admins mailing list
</I>&gt;&gt;<i> &gt;&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">Sorcerer-admins at lists.berlios.de</A>
</I>&gt;&gt;<i> &gt;&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">https://lists.berlios.de/mailman/listinfo/sorcerer-admins</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; _______________________________________________
</I>&gt;&gt;<i> &gt; Sorcerer-admins mailing list
</I>&gt;&gt;<i> &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">Sorcerer-admins at lists.berlios.de</A>
</I>&gt;&gt;<i> &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">https://lists.berlios.de/mailman/listinfo/sorcerer-admins</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> Evert Vorster
</I>&gt;&gt;<i> Chief Observer
</I>&gt;&gt;<i> WG Cook
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Sorcerer-admins mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">Sorcerer-admins at lists.berlios.de</A>
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">https://lists.berlios.de/mailman/listinfo/sorcerer-admins</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Sorcerer-admins mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">Sorcerer-admins at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">https://lists.berlios.de/mailman/listinfo/sorcerer-admins</A>
</I>


-- 
Evert Vorster
Chief Observer
WG Cook
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002493.html">[Sorcerer-admins] Augur man page and GCC optimization
</A></li>
	<LI>Next message: <A HREF="002498.html">[Sorcerer-admins] Augur man page and GCC optimization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2495">[ date ]</a>
              <a href="thread.html#2495">[ thread ]</a>
              <a href="subject.html#2495">[ subject ]</a>
              <a href="author.html#2495">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">More information about the Sorcerer-admins
mailing list</a><br>
</body></html>
