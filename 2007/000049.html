<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Sorcerer-admins] glibc..... cast issue
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/sorcerer-admins/2007/index.html" >
   <LINK REL="made" HREF="mailto:sorcerer-admins%40lists.berlios.de?Subject=Re%3A%20%5BSorcerer-admins%5D%20glibc.....%20cast%20issue&In-Reply-To=%3C45F54762.3060702%40laposte.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000048.html">
   <LINK REL="Next"  HREF="000050.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Sorcerer-admins] glibc..... cast issue</H1>
    <B>jlm devel</B> 
    <A HREF="mailto:sorcerer-admins%40lists.berlios.de?Subject=Re%3A%20%5BSorcerer-admins%5D%20glibc.....%20cast%20issue&In-Reply-To=%3C45F54762.3060702%40laposte.net%3E"
       TITLE="[Sorcerer-admins] glibc..... cast issue">jlm_devel at laposte.net
       </A><BR>
    <I>Mon Mar 12 13:28:18 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000048.html">[Sorcerer-admins] glibc..... cast issue
</A></li>
        <LI>Next message: <A HREF="000050.html">[Sorcerer-admins] glibc..... cast issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49">[ date ]</a>
              <a href="thread.html#49">[ thread ]</a>
              <a href="subject.html#49">[ subject ]</a>
              <a href="author.html#49">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Kyle Sallee a &#233;crit :
&gt;<i> Perhaps seeing double was the expected effect of
</I>&gt;<i> # augur scry glibc
</I>&gt;<i> executed at that moment.
</I>&gt;<i>
</I>&gt;<i> Upon execution of augur scry
</I>&gt;<i> the compile log is first cat.
</I>&gt;<i> Then, it is followed with tail.
</I>&gt;<i> Due to executing both cat and tail
</I>&gt;<i> the last line or lines that exist
</I>&gt;<i> when augur scry is executed
</I>&gt;<i> may be printed more than once.
</I>&gt;<i>
</I>&gt;<i> If that is the case then the only way to be certain
</I>&gt;<i> that it did not dispel twice
</I>&gt;<i> is to look at the compile log,
</I>&gt;<i> probably /usr/src/sorcery/.meta/glibc.log
</I>&gt;<i>
</I>&gt;<i> It probably did not dispel twice.
</I>&gt;<i>   
</I>looking in the compile log I have I found that :

Performing a quick test to see if the new glibc works.
glibc is ready to install.
ESC[36mPreparing to install ESC[37mESC[1mESC[40mglibcESC[0mESC[0m
xargs: rm: No such file or directory
/usr/libexec/sorcery/dispel: line 123: /usr/bin/sort: No such file or 
directory
/usr/libexec/sorcery/share: line 2990: /bin/sed: No such file or directory
ESC[35mESC[1mDispelled spell: ESC[37mESC[1mESC[40mglibcESC[0mESC[0m
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory
grep: error while loading shared libraries: libpcre.so.0: cannot open 
shared obj
ect file: No such file or directory




&gt;<i>
</I>&gt;<i> glibc fails to cast for usually one of two reasons.
</I>&gt;<i> Either the install log for the installed glibc is incorrect.
</I>&gt;<i>   
</I>looking the install log of glibc I get an empty file.... maybe it's the 
problem?
how can we fix that?

&gt;<i> Or bits and pieces of untracked and older glibc exist
</I>&gt;<i> in /lib, or on x86_64 architecture in /lib64.
</I>&gt;<i>
</I>&gt;<i> Doing checks before casting glibc on a box where it is
</I>&gt;<i> expected to fail is probably best.
</I>&gt;<i> The task is fairly easy for a SA,
</I>&gt;<i> but difficult to script since a wrong
</I>&gt;<i> assumption made during the creation
</I>&gt;<i> of the script could cause glibc to break
</I>&gt;<i> upon the script's execution.
</I>&gt;<i> When an alien file must be pruned from /lib
</I>&gt;<i> the SA should be careful to prune the files
</I>&gt;<i> that should be pruned and log the files in
</I>&gt;<i> the glibc log that should be kept.
</I>&gt;<i>
</I>&gt;<i> Below are some sample tests a SA might try:
</I>&gt;<i>
</I>&gt;<i> # for file in /lib/*; do grep -qrx &quot;$file&quot; /etc/sorcery/log/install ||
</I>&gt;<i> echo &quot;$file&quot;; done
</I>&gt;<i>
</I>&gt;<i> The above may display untracked files in /lib
</I>&gt;<i>
</I>&gt;<i> ls /etc/sorcery/log/install/glibc*
</I>&gt;<i>
</I>&gt;<i> Is something called glibc-failed installed?
</I>&gt;<i> That would cause a break.
</I>&gt;<i> Something called glibc-dev installed?
</I>&gt;<i> Is the glibc install log mysteriously absent?
</I>&gt;<i> Those could all become problems.
</I>&gt;<i>
</I>&gt;<i> # grep &quot;^/lib/&quot; /etc/sorcery/log/install/glibc | while read; do [ -e
</I>&gt;<i> &quot;$REPLY&quot; ] || echo &quot;$REPLY&quot;; done
</I>&gt;<i>
</I>&gt;<i> Did it print that any lines starting with /lib/ are tracked but do not exist?
</I>&gt;<i> If it did then the glibc install log may not be correct
</I>&gt;<i> for the installed version of glibc.
</I>&gt;<i> Directly modify glibc's install log to correct it.
</I>&gt;<i>
</I>&gt;<i> What spells installed files in /lib/?
</I>&gt;<i> Should not be many.
</I>&gt;<i>
</I>&gt;<i> # grep -lr &quot;^/lib/&quot; /etc/sorcery/log/install | cut -d / -f6
</I>&gt;<i> glibc
</I>&gt;<i> bzip2
</I>&gt;<i> gcc
</I>&gt;<i> libcap
</I>&gt;<i> init-functions
</I>&gt;<i> procps
</I>&gt;<i> shadow
</I>&gt;<i> linux-fusion
</I>&gt;<i> zlib
</I>&gt;<i> pcre
</I>&gt;<i> udev
</I>&gt;<i> e2fsprogs
</I>&gt;<i> acl
</I>&gt;<i> linux
</I>&gt;<i> kqemu
</I>&gt;<i> ncurses
</I>&gt;<i> device-mapper
</I>&gt;<i> readline
</I>&gt;<i> fuse
</I>&gt;<i> attr
</I>&gt;<i>
</I>&gt;<i> Is there a spell with files installed under /lib that
</I>&gt;<i> perhaps should not be installed?
</I>&gt;<i>
</I>&gt;<i> # grep &quot;^/lib/&quot; /etc/sorcery/log/install/glibc
</I>&gt;<i>
</I>&gt;<i> /lib/ld-2.3.6.so
</I>&gt;<i> /lib/ld-linux.so.2
</I>&gt;<i> /lib/libBrokenLocale-2.3.6.so
</I>&gt;<i> /lib/libBrokenLocale.so.1
</I>&gt;<i> /lib/libSegFault.so
</I>&gt;<i> /lib/libanl-2.3.6.so
</I>&gt;<i> /lib/libanl.so.1
</I>&gt;<i> /lib/libc-2.3.6.so
</I>&gt;<i> /lib/libc.so.6
</I>&gt;<i> /lib/libcidn-2.3.6.so
</I>&gt;<i> /lib/libcidn.so.1
</I>&gt;<i> /lib/libcrypt-2.3.6.so
</I>&gt;<i> /lib/libcrypt.so.1
</I>&gt;<i> /lib/libdl-2.3.6.so
</I>&gt;<i> /lib/libdl.so.2
</I>&gt;<i> /lib/libm-2.3.6.so
</I>&gt;<i> /lib/libm.so.6
</I>&gt;<i> /lib/libmemusage.so
</I>&gt;<i> /lib/libnsl-2.3.6.so
</I>&gt;<i> /lib/libnsl.so.1
</I>&gt;<i> /lib/libnss_compat-2.3.6.so
</I>&gt;<i> /lib/libnss_compat.so.2
</I>&gt;<i> /lib/libnss_dns-2.3.6.so
</I>&gt;<i> /lib/libnss_dns.so.2
</I>&gt;<i> /lib/libnss_files-2.3.6.so
</I>&gt;<i> /lib/libnss_files.so.2
</I>&gt;<i> /lib/libnss_hesiod-2.3.6.so
</I>&gt;<i> /lib/libnss_hesiod.so.2
</I>&gt;<i> /lib/libnss_nis-2.3.6.so
</I>&gt;<i> /lib/libnss_nis.so.2
</I>&gt;<i> /lib/libnss_nisplus-2.3.6.so
</I>&gt;<i> /lib/libnss_nisplus.so.2
</I>&gt;<i> /lib/libpcprofile.so
</I>&gt;<i> /lib/libpthread-2.3.6.so
</I>&gt;<i> /lib/libpthread.so.0
</I>&gt;<i> /lib/libresolv-2.3.6.so
</I>&gt;<i> /lib/libresolv.so.2
</I>&gt;<i> /lib/librt-2.3.6.so
</I>&gt;<i> /lib/librt.so.1
</I>&gt;<i> /lib/libthread_db-1.0.so
</I>&gt;<i> /lib/libthread_db.so.1
</I>&gt;<i> /lib/libutil-2.3.6.so
</I>&gt;<i> /lib/libutil.so.1
</I>&gt;<i>
</I>&gt;<i> Are there files in /lib that should be on the above
</I>&gt;<i> list but mysteriously missing.
</I>&gt;<i> A clean reap of the installed glibc is essential
</I>&gt;<i> for the newly compiled glibc to install successfully.
</I>&gt;<i>
</I>&gt;<i> There is a high probability that you will spot and
</I>&gt;<i> be able to correct the problem if you check for it.
</I>&gt;<i> I apologize that is not something that I can script
</I>&gt;<i> for and feel safe and satisfied about the script.
</I>&gt;<i> However, I can check the box personally 1st hand if you want.
</I>&gt;<i> If what I wrote above does not solve the problem,
</I>&gt;<i> which it should solve in most cases,
</I>&gt;<i> then the problem will probably only be detected
</I>&gt;<i> and solve by direct inspection by a SA.
</I>&gt;<i> Could be something odd like an old or untracked or
</I>&gt;<i> developmental version of binutils installed
</I>&gt;<i> or an unexpected problem due to the compiler being used
</I>&gt;<i> or one or more trojaned executables installed.
</I>&gt;<i> Those possibilities are so remote I can not begin to estimate the odds.
</I>&gt;<i>
</I>&gt;<i> I once inspected a box that could not tracked files installed
</I>&gt;<i> by spells because the installed version of findutils was broken.
</I>&gt;<i> Oh, that was so long ago now that the findutils spell no longer
</I>&gt;<i> even contains the comment about what version to never use.
</I>&gt;<i> However, I would expect that a box broken in that way would
</I>&gt;<i> either be unable to cast glibc, or unable to cast a newer glibc
</I>&gt;<i> after the older glibc installed, because the install log for the
</I>&gt;<i> older installed glibc would be lacking entries for files that
</I>&gt;<i> were installed in /lib/
</I>&gt;<i>
</I>&gt;<i> It may even be possible, although unlikely,
</I>&gt;<i> that a problem with a file installed in /usr/include
</I>&gt;<i> may cause glibc to mis-compile.
</I>&gt;<i> However, that is very unlikely since the glibc spell
</I>&gt;<i> provides not only the glibc header files to use,
</I>&gt;<i> but also the specific linux kernel header files to use
</I>&gt;<i> for compilation of glibc.
</I>&gt;<i>
</I>&gt;<i> Try the recommended above checks please.
</I>&gt;<i> I apologize for harping about it.
</I>&gt;<i> But there is no sense going on a wild goose chase
</I>&gt;<i> before shooting the ducks floating in the barrel.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 3/9/07, xyz &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">jlm_devel at laposte.net</A>&gt; wrote:
</I>&gt;<i>   
</I>&gt;&gt;<i> hi!
</I>&gt;&gt;<i> i've been doing several stuff lately and I hadn't time to
</I>&gt;&gt;<i> inspect this problem I have on ;y pc with upgrade of glibc....
</I>&gt;&gt;<i> so the glibc compile fine and seems to install to... and
</I>&gt;&gt;<i> sudenly my pc freeze and I can't login again.... in fact I can
</I>&gt;&gt;<i> only switch of console but when I try to enter login nothing
</I>&gt;&gt;<i> happen.... same ctrl-alt-suppr to reboot have no effect
</I>&gt;&gt;<i> It happen all the time I cast glibc....
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> today I tried a cast of glibc and I started 2 augur scry :
</I>&gt;&gt;<i> augur scry
</I>&gt;&gt;<i> augur scry glibc
</I>&gt;&gt;<i> on 2 console
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I noticed something strange on augur scry glibc screen :
</I>&gt;&gt;<i> performing quick test to see if the new glibc works
</I>&gt;&gt;<i> glibc is ready to install
</I>&gt;&gt;<i> preparing to install glibc
</I>&gt;&gt;<i> dispelled spell : glibc
</I>&gt;&gt;<i> dispelled spell : glibc
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> it's not an error of me, there is 2 lines saying a
</I>&gt;&gt;<i> dispell..... and after this.... I can do nothing else than
</I>&gt;&gt;<i> hardreseting the box......
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> does anyone have the same problem?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> best regards
</I>&gt;&gt;<i> jlm
</I>&gt;&gt;<i>     
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Sorcerer-admins mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">Sorcerer-admins at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">https://lists.berlios.de/mailman/listinfo/sorcerer-admins</A>
</I>&gt;<i>   
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/sorcerer-admins/attachments/20070312/cf669a9e/attachment.html">https://lists.berlios.de/pipermail/sorcerer-admins/attachments/20070312/cf669a9e/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000048.html">[Sorcerer-admins] glibc..... cast issue
</A></li>
	<LI>Next message: <A HREF="000050.html">[Sorcerer-admins] glibc..... cast issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49">[ date ]</a>
              <a href="thread.html#49">[ thread ]</a>
              <a href="subject.html#49">[ subject ]</a>
              <a href="author.html#49">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">More information about the Sorcerer-admins
mailing list</a><br>
</body></html>
