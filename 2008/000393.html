<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Sorcerer-admins] MesaLib failling compilation
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/sorcerer-admins/2008/index.html" >
   <LINK REL="made" HREF="mailto:sorcerer-admins%40lists.berlios.de?Subject=Re%3A%20%5BSorcerer-admins%5D%20MesaLib%20failling%20compilation&In-Reply-To=%3C47B23328.206%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000392.html">
   <LINK REL="Next"  HREF="000394.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Sorcerer-admins] MesaLib failling compilation</H1>
    <B>MALET Jean-Luc</B> 
    <A HREF="mailto:sorcerer-admins%40lists.berlios.de?Subject=Re%3A%20%5BSorcerer-admins%5D%20MesaLib%20failling%20compilation&In-Reply-To=%3C47B23328.206%40gmail.com%3E"
       TITLE="[Sorcerer-admins] MesaLib failling compilation">jeanluc.malet at gmail.com
       </A><BR>
    <I>Wed Feb 13 01:00:40 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000392.html">[Sorcerer-admins] MesaLib failling compilation
</A></li>
        <LI>Next message: <A HREF="000394.html">[Sorcerer-admins] MesaLib failling compilation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#393">[ date ]</a>
              <a href="thread.html#393">[ thread ]</a>
              <a href="subject.html#393">[ subject ]</a>
              <a href="author.html#393">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>sorry here are the end of the logs :
make[2]: quittant le r&#233;pertoire &#171; /usr/src/sorcery/MesaLib/Mesa-6.5.2/src &#187;
make[2]: entrant dans le r&#233;pertoire &#171; 
/usr/src/sorcery/MesaLib/Mesa-6.5.2/progs &#187;
Making programs for linux-dri-x86
make[2]: quittant le r&#233;pertoire &#171; 
/usr/src/sorcery/MesaLib/Mesa-6.5.2/progs &#187;
make[1]: quittant le r&#233;pertoire &#171; /usr/src/sorcery/MesaLib/Mesa-6.5.2 &#187;
gcc -I../../include -Wall -Wmissing-prototypes -std=c99 -ffast-math -O 
-g  -m32 -D_POSIX_SOURCE -D_POSIX_C_SOURCE=199309L -D_SVID_SOURCE 
-D_BSD_SOURCE -D_GNU_SOURCE -DPTHREADS -DUSE_EXTERNAL_DXTN_LIB=1 
-DIN_DRI_DRIVER -DGLX_DIRECT_RENDERING -DGLX_INDIRECT_RENDERING 
-DHAVE_ALIAS -DHAVE_POSIX_MEMALIGN -DUSE_X86_ASM -DUSE_MMX_ASM 
-DUSE_3DNOW_ASM -DUSE_SSE_ASM glxinfo.c -L../../lib -lglut -lGLU -lGL 
-lm -o glxinfo
../../lib/libGLU.so: undefined reference to `operator new[](unsigned 
int)@GLIBCXX_3.4'
../../lib/libGLU.so: undefined reference to `operator 
delete(void*)@GLIBCXX_3.4'
../../lib/libGLU.so: undefined reference to `vtable for 
__cxxabiv1::<A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">__class_type_info at CXXABI_1.3</A>'
../../lib/libGLU.so: undefined reference to 
`<A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">__gxx_personality_v0 at CXXABI_1.3</A>'
../../lib/libGLU.so: undefined reference to `operator 
delete[](void*)@GLIBCXX_3.4'
../../lib/libGLU.so: undefined reference to `vtable for 
__cxxabiv1::<A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">__si_class_type_info at CXXABI_1.3</A>'
../../lib/libGLU.so: undefined reference to `vtable for 
__cxxabiv1::<A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">__vmi_class_type_info at CXXABI_1.3</A>'
../../lib/libGLU.so: undefined reference to `<A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">__cxa_pure_virtual at CXXABI_1.3</A>'
../../lib/libGLU.so: undefined reference to `operator new(unsigned 
int)@GLIBCXX_3.4'
collect2: ld a retourn&#233; 1 code d'&#233;tat d'ex&#233;cution
make: *** [glxinfo] Erreur 1
ESC[31mESC[1m! Problem Detected !ESC[0mESC[0m
Source moved to /var/tmp/failed/Mesa-6.5.2
(END)



ia32 architechture
maybe the no strict aliasing is the cause... will try it shortly
thanks
JLM


Kyle Sallee wrote:
&gt;<i> Thanks for the info.
</I>&gt;<i> However, those messages about:
</I>&gt;<i>
</I>&gt;<i> cannot find include file &quot;stddef.h&quot;
</I>&gt;<i>
</I>&gt;<i> are common in MesaLib.
</I>&gt;<i> They do not break compilation.
</I>&gt;<i>
</I>&gt;<i> I have already compiled MesaLib
</I>&gt;<i> Compile log for MesaLib 7.0.1c
</I>&gt;<i> Built with sorcery implosion-20080206-0 and gcc 4.2.3
</I>&gt;<i> Built on Wed Feb  6 13:54:13 MST 2008
</I>&gt;<i> ...
</I>&gt;<i> make[1]: Leaving directory `/usr/src/sorcery/MesaLib/Mesa-7.0.1/progs'
</I>&gt;<i> `progs/xdemos/glxgears' -&gt; `/usr/bin/glxgears'
</I>&gt;<i> `progs/xdemos/glxinfo' -&gt; `/usr/bin/glxinfo'
</I>&gt;<i> `/root/.sorcery/grimoire/MesaLib.d/drirc' -&gt; `/etc/drirc'
</I>&gt;<i>
</I>&gt;<i> If MesaLib fails compilation
</I>&gt;<i> then you may want to include the lines from
</I>&gt;<i> the compile log towards the end
</I>&gt;<i> that sometimes show a useful error message.
</I>&gt;<i> Or you can send the gziped compile log
</I>&gt;<i> directly to me as an attachment.
</I>&gt;<i>
</I>&gt;<i> Probably the most recent change to MesaLib was:
</I>&gt;<i>
</I>&gt;<i>  # According to Evert Vorster
</I>&gt;<i>  # MesaLib should be compiled with -fno-strict-aliasing added to CFLAGS
</I>&gt;<i>  # in order for OpenGL to work with xf86-video-intel drivers
</I>&gt;<i>  CFLAGS+=' -fno-strict-aliasing'
</I>&gt;<i>
</I>&gt;<i> Did adding that to CFLAGS
</I>&gt;<i> cause a compile error?
</I>&gt;<i> Is the error happening on ia32
</I>&gt;<i> or x86_64 architecture, please?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>   
</I>&gt;&gt;<i> why are the gcc's include path not in the seeked path of MesaLib spell?
</I>&gt;&gt;<i>     
</I>&gt;<i>
</I>&gt;<i> MesaLib may have a bit of legacy code in it
</I>&gt;<i> that was inherited from XFree86.
</I>&gt;<i> For example it requires makedepend to compile.
</I>&gt;<i> Almost nothing from xorg still uses makedepend.
</I>&gt;<i> And that appears to be somehow related to
</I>&gt;<i> the messages about stdef.h
</I>&gt;<i>
</I>&gt;<i> makedepend: warning:  glcontextmodes.c (reading
</I>&gt;<i> /usr/X11R6/include/sys/types.h, line 147): cannot find include file
</I>&gt;<i> &quot;stddef.h&quot;
</I>&gt;<i>
</I>&gt;<i> However, as long as warnings are not being
</I>&gt;<i> regarded as errors this should not create a problem.
</I>&gt;<i> stddef.h is a header file from gcc.
</I>&gt;<i> gcc always knows where to find it's own headers.
</I>&gt;<i> They can be included using include lines in sources
</I>&gt;<i> and other headers without requiring an appropriate
</I>&gt;<i> hyphen capital I to indicate what directory that are in.
</I>&gt;<i> Even if that is given to MesaLib those warning
</I>&gt;<i> messages might still occur since they are comming
</I>&gt;<i> from makedepend and no gcc.
</I>&gt;<i> Because as I mentioned above gcc and g++
</I>&gt;<i> always knows where to find it's own header files.
</I>&gt;<i> That is why there are no significant gcc caused
</I>&gt;<i> problems by installing gcc in /opt
</I>&gt;<i>
</I>&gt;<i> On the other hand libtool causes all sorts of problems.
</I>&gt;<i> That is why the current version of gcc is now
</I>&gt;<i> installed in /usr while older versions are installed in /opt
</I>&gt;<i> First, that avoids some libtool problems.
</I>&gt;<i> But libtool may create additional problems when
</I>&gt;<i> compiling a source that uses libtool with a different
</I>&gt;<i> version of gcc than was used to compile the libraries
</I>&gt;<i> that the currently compiling source requires.
</I>&gt;<i> Given that libtool can still cause problems.
</I>&gt;<i> Second, new Sorcerer SAs sometimes start asking
</I>&gt;<i> me why gcc is installed in /opt/gcc/ and so forth...
</I>&gt;<i> Novice SAs are a bit confused by it.
</I>&gt;<i> Third, I since modern releases of gcc support
</I>&gt;<i> the -march=native I feel inspired to add support
</I>&gt;<i> to cast for correctly selecting optimizations
</I>&gt;<i> in the event that an expected cpref file is not
</I>&gt;<i> discovered in /etc/sorcery/cpref/
</I>&gt;<i>
</I>&gt;<i> This you may find amusing.
</I>&gt;<i> Nearly all sources will compile with something like
</I>&gt;<i> -march=native -O
</I>&gt;<i> -Wl,-s
</I>&gt;<i>
</I>&gt;<i> That yields a moderately fast compile time
</I>&gt;<i> while stripping ELF libraries and executables.
</I>&gt;<i>
</I>&gt;<i> However, for some spells I have specified
</I>&gt;<i> CFLAGS and/or LDFLAGS in the spell definition.
</I>&gt;<i> MesaLib, for example,
</I>&gt;<i> now has:
</I>&gt;<i>
</I>&gt;<i>     CFLAGS='-O3'
</I>&gt;<i>    LDFLAGS='-Wl,-O1'
</I>&gt;<i>
</I>&gt;<i> That would be the most recent change to MesaLib
</I>&gt;<i> which might cause a compile error.
</I>&gt;<i> However, it probably does not effect your
</I>&gt;<i> compilation because
</I>&gt;<i> If a cpref file exists then the cpref file is used
</I>&gt;<i> instead of the in spell recommendations.
</I>&gt;<i> And the automatic optimization would naturally
</I>&gt;<i> add the appropriate -march to the CFLAGS
</I>&gt;<i> and CXXFLAGS
</I>&gt;<i>
</I>&gt;<i> Moving along to the point of the change is
</I>&gt;<i> that by not using cpref files a box can compile
</I>&gt;<i> with the higher level of optimization in sources
</I>&gt;<i> that are expected to benefit from it.
</I>&gt;<i> Sources that install libraries or executables
</I>&gt;<i> capable of running the CPU at full bore for
</I>&gt;<i> seconds or minutes at a time receive higher
</I>&gt;<i> levels of optimization:
</I>&gt;<i> gzip, bzip2, p7zip, bash, MesaLib, sed, coreutils,
</I>&gt;<i> etc....
</I>&gt;<i>
</I>&gt;<i> Normally, a SA might set aggressive or fast
</I>&gt;<i> for cpref for those spells, but now without
</I>&gt;<i> a default cpref file the SA can go along with
</I>&gt;<i> the recommended CFLAGS, CXXFLAGS, and
</I>&gt;<i> LDFLAGS that are specified in the spell.
</I>&gt;<i> Naturally, very few spells have CFLAGS,
</I>&gt;<i> CXXFLAGS, or LDFLAGS specified.
</I>&gt;<i>
</I>&gt;<i> Therefore, this change amounts to
</I>&gt;<i> decreased SA effort,
</I>&gt;<i> improved performance,
</I>&gt;<i> and reduced compile time.
</I>&gt;<i> And SAs that want to continue using cpref
</I>&gt;<i> files may continue to use cpref files.
</I>&gt;<i> The functionality we now enjoy is not going away.
</I>&gt;<i>
</I>&gt;<i> Also changed is ccache behavior.
</I>&gt;<i> gcc* attribute kde3 spells no longer
</I>&gt;<i> compile with ccache when ccache is installed.
</I>&gt;<i> Also spells with estimates less than 500
</I>&gt;<i> will compile without ccache.
</I>&gt;<i> There are numerous reasons for this change.
</I>&gt;<i> However, I will skip the explanation.
</I>&gt;<i> This change like the cpref change should
</I>&gt;<i> overall reduce compilation time
</I>&gt;<i> and conserve disk space
</I>&gt;<i> and reduce amount of CPU spent re-compressing
</I>&gt;<i> ccache archive files in /var/cache/ccache/
</I>&gt;<i>
</I>&gt;<i> The trend of these changes is to make sorcery
</I>&gt;<i> more innately do what SAs want by providing
</I>&gt;<i> a good compromise between stability
</I>&gt;<i> performance and compilation time
</I>&gt;<i> with less effort from from the SA.
</I>&gt;<i>
</I>&gt;<i> Also in newer versions of sorcery is a slightly
</I>&gt;<i> modified appearance for # augur scry
</I>&gt;<i> It provides less information.
</I>&gt;<i> But the appearance is more uniform.
</I>&gt;<i> This makes reading the state of progress
</I>&gt;<i> faster to accomplish in a single glance.
</I>&gt;<i>
</I>&gt;<i> Because gcc is migrating from /opt/gcc/current
</I>&gt;<i> to /usr this will cause many ELF failures.
</I>&gt;<i> These are actually pseudo failures.
</I>&gt;<i> Installed ELFs that link with libstdc++
</I>&gt;<i> will still continue to work just fine.
</I>&gt;<i> However, cast will consider the errors real.
</I>&gt;<i> And it will recast almost every spell
</I>&gt;<i> that installs ELFs that are linked with libstdc++
</I>&gt;<i> As long as future versions of
</I>&gt;<i> gcc are installed into /usr
</I>&gt;<i> then this forced recompilation will be the last.
</I>&gt;<i>
</I>&gt;<i> I debated about whether to sedit the sorcery
</I>&gt;<i> logs in /etc/sorcery/log/ldd/ to prevent the
</I>&gt;<i> massive amount of ELF failures.
</I>&gt;<i> You can elect to do so if you want.
</I>&gt;<i> However, I decided that for those who may
</I>&gt;<i> have been holding installed spells for a long time
</I>&gt;<i> that this may be a good opportunity to shake
</I>&gt;<i> the dust off the fixed disks.
</I>&gt;<i> This is about as close as Sorcerer boxes ever
</I>&gt;<i> come to having to be re-installed from a newer
</I>&gt;<i> Install/Rescue release.
</I>&gt;<i>
</I>&gt;<i> In addition to the improvements in sorcery tools
</I>&gt;<i> some previous functionality has been moved
</I>&gt;<i> into spells:
</I>&gt;<i>
</I>&gt;<i> sorcery-bgz  for background compression daemon
</I>&gt;<i> sorcery-alien for monthly check for alien files
</I>&gt;<i> sorcery-defrag for monthly file de-fragmentation
</I>&gt;<i> sorcery-md5sum for weekly md5sum checks
</I>&gt;<i>
</I>&gt;<i> Having these as spells provides
</I>&gt;<i> a good convenience for SAs.
</I>&gt;<i>
</I>&gt;<i> For example to view the alien list
</I>&gt;<i> I merely type:
</I>&gt;<i> # augur compile sorcery-alien
</I>&gt;<i> The compile log from the last time it ran
</I>&gt;<i> shows what aliens were discovered.
</I>&gt;<i>
</I>&gt;<i> The monthly de-fragmentation provides a
</I>&gt;<i> good way to keep performance up and drive
</I>&gt;<i> wear and tear down.
</I>&gt;<i> Tested on ext3 each cast eliminated
</I>&gt;<i> fragmentation from 1/3 of the installed
</I>&gt;<i> fragmented files.
</I>&gt;<i>
</I>&gt;<i> As for the weekly md5sum check.
</I>&gt;<i> It locates unexpected modified and/or corrupt files,
</I>&gt;<i> enters into the cast queue
</I>&gt;<i> those spells owning those files
</I>&gt;<i> and since cast is already running
</I>&gt;<i> cast recompiles those spells.
</I>&gt;<i> For the SA that regularly does md5sum checks
</I>&gt;<i> hanging the md5sum check on a weekly spell
</I>&gt;<i> gains a &quot;fire and forget&quot; solution for maintaining
</I>&gt;<i> file integrity.
</I>&gt;<i>
</I>&gt;<i> All of these improvements come with a slight
</I>&gt;<i> chance of instability and bugs.
</I>&gt;<i> Please make bug reports as you encounter the bugs.
</I>&gt;<i> For the cost of some cooperation
</I>&gt;<i> we can achieve better performance,
</I>&gt;<i> improved functionality while decreasing
</I>&gt;<i> the overall workload upon the SA.
</I>&gt;<i> If Sorcerer was a wheel
</I>&gt;<i> then one might say we are truing it up for 2008.
</I>&gt;<i> Once the transition is complete
</I>&gt;<i> prepare for a smooth fast ride.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Sorcerer-admins mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">Sorcerer-admins at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">https://lists.berlios.de/mailman/listinfo/sorcerer-admins</A>
</I>&gt;<i>   
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/sorcerer-admins/attachments/20080213/3c8349df/attachment.html">https://lists.berlios.de/pipermail/sorcerer-admins/attachments/20080213/3c8349df/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000392.html">[Sorcerer-admins] MesaLib failling compilation
</A></li>
	<LI>Next message: <A HREF="000394.html">[Sorcerer-admins] MesaLib failling compilation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#393">[ date ]</a>
              <a href="thread.html#393">[ thread ]</a>
              <a href="subject.html#393">[ subject ]</a>
              <a href="author.html#393">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/sorcerer-admins">More information about the Sorcerer-admins
mailing list</a><br>
</body></html>
